$((function(){var a={is_running:!1,data_index:0,data_count:67,is_loading:{},progress:$("#progress"),init:function(){var a,t=this,i=$("#stage");for(t.data_matrix=[],a=0;a<t.frame_row;++a)t.data_matrix[a]=Array(t.frame_col).join(" ").split("");t.canvas=i.get(0),t.ctx=t.canvas.getContext("2d"),t.canvas.width=7*t.frame_col,t.canvas.height=16*t.frame_row,t.ctx.fillStyle="rgba(0, 0, 0, .05)",t.ctx.fillRect(0,0,t.canvas.width,t.canvas.height),t.ctx.fillStyle="#7E7E7E",t.ctx.font="12px monospace",$("#audio").attr("src","https://music.163.com/song/media/outer/url?id=22645196.mp3"),$("#audio")[0].play()},load_data:function(a,t,i){var n=this;n.is_loading[a]||(n.is_loading[a]=!0,$.get("data/data_"+a+".txt",(function(r){if(n.is_loading[a]=null,n.data_index=a,r=r.split("\n"),n.progress.html((a/n.data_count*100).toFixed(2)+"%"),n.data)n.data=n.data.concat(r);else{n.data=r;var o=r[0].split(" ");n.frame_row=parseInt(o[0]),n.frame_col=parseInt(o[1]),$("#div_loading").remove(),n.init()}t>1&&a<n.data_count?n.load_data(a+1,t-1,i):i&&i()})))},draw_frame:function(a){var t,i=this;for(t=0;t<a.length;++t)i.data_matrix[a[t][0]-1][a[t][1]-1]=a[t][2];for(i.ctx.clearRect(0,0,i.canvas.width,i.canvas.height),t=0;t<i.frame_row;++t)i.ctx.fillText(i.data_matrix[t].join(""),4,14*t+16)},play:function(){var a,t,i,n=this,r=0;n.is_running=!0,n.interval||(n.interval=setInterval((function(){if(n.is_running&&r<n.data.length){if(t=n.data[++r],i=[],t&&!/^\s*$/.test(t))for(t=t.split("|"),a=0;a<t.length;++a)i[a]=t[a].split("_");n.draw_frame(i),r+16>16*n.data_index&&n.data_index<n.data_count&&n.load_data(n.data_index+1,2)}}),70))},start:function(){var a=this;a.data?a.play():a.load_data(0,1,(function(){a.play()}))},stop:function(){this.is_running=!1},terminal:function(){this.stop(),clearInterval(this.interval)}};$("#stage").click((function(){a.is_running?a.stop():a.start()})).click()}));